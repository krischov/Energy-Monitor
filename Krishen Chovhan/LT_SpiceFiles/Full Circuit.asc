Version 4
SHEET 1 4772 1444
WIRE 4192 -384 2656 -384
WIRE 1104 -304 736 -304
WIRE 1952 -304 1104 -304
WIRE 2352 -304 1952 -304
WIRE 3648 -304 2352 -304
WIRE 3920 -304 3648 -304
WIRE 256 -176 -16 -176
WIRE 1440 -176 256 -176
WIRE 2688 -176 1440 -176
WIRE 2768 -176 2752 -176
WIRE 2880 -176 2848 -176
WIRE 2912 -176 2880 -176
WIRE 2992 -176 2912 -176
WIRE 3328 -176 3248 -176
WIRE 3488 -176 3328 -176
WIRE 3648 -176 3648 -304
WIRE 3648 -176 3488 -176
WIRE 4064 -176 3776 -176
WIRE 256 -144 256 -176
WIRE 3920 -112 3920 -304
WIRE 3776 -96 3776 -176
WIRE 3888 -96 3776 -96
WIRE 4064 -80 4064 -176
WIRE 4064 -80 3952 -80
WIRE 4192 -80 4192 -384
WIRE 4192 -80 4064 -80
WIRE 3648 -64 3648 -96
WIRE 3888 -64 3648 -64
WIRE 3648 -32 3648 -64
WIRE 256 0 256 -64
WIRE -16 16 -16 -176
WIRE 1104 32 1104 -304
WIRE 2352 32 2352 -304
WIRE 1072 48 1056 48
WIRE 2320 48 2304 48
WIRE 2912 48 2912 -176
WIRE 3328 48 3328 -176
WIRE 3488 48 3488 -176
WIRE 1200 64 1136 64
WIRE 2448 64 2384 64
WIRE 576 80 560 80
WIRE 688 80 656 80
WIRE 1072 80 880 80
WIRE 1440 80 1440 -176
WIRE 1776 80 1760 80
WIRE 1888 80 1856 80
WIRE 2320 80 2112 80
WIRE 3648 80 3648 48
WIRE 448 144 400 144
WIRE 560 144 560 80
WIRE 560 144 528 144
WIRE 736 144 736 -304
WIRE 736 144 624 144
WIRE 1648 144 1600 144
WIRE 1760 144 1760 80
WIRE 1760 144 1728 144
WIRE 1952 144 1952 -304
WIRE 1952 144 1824 144
WIRE 560 160 560 144
WIRE 592 160 560 160
WIRE 1760 160 1760 144
WIRE 1792 160 1760 160
WIRE 688 176 688 80
WIRE 688 176 656 176
WIRE 752 176 688 176
WIRE 880 176 880 80
WIRE 880 176 832 176
WIRE 944 176 880 176
WIRE 1888 176 1888 80
WIRE 1888 176 1856 176
WIRE 1984 176 1888 176
WIRE 2112 176 2112 80
WIRE 2112 176 2064 176
WIRE 2176 176 2112 176
WIRE 592 192 560 192
WIRE 1792 192 1760 192
WIRE 256 208 256 80
WIRE 448 208 256 208
WIRE 560 208 560 192
WIRE 560 208 528 208
WIRE 880 208 880 176
WIRE 1440 208 1440 160
WIRE 1648 208 1440 208
WIRE 1760 208 1760 192
WIRE 1760 208 1728 208
WIRE 2112 208 2112 176
WIRE 560 224 560 208
WIRE 624 224 624 208
WIRE 640 224 624 224
WIRE 1760 224 1760 208
WIRE 1824 240 1824 208
WIRE 1856 240 1824 240
WIRE 1440 256 1440 208
WIRE 256 368 256 208
WIRE 560 384 560 304
WIRE 1056 384 1056 48
WIRE 1056 384 560 384
WIRE 1760 384 1760 304
WIRE 1760 384 1056 384
WIRE 2304 384 2304 48
WIRE 2304 384 1760 384
WIRE 2656 384 2656 -384
WIRE 2656 384 2304 384
WIRE 3648 400 3648 160
WIRE -16 480 -16 96
WIRE 256 480 256 448
WIRE 256 480 -16 480
WIRE 400 480 400 144
WIRE 400 480 256 480
WIRE 640 480 640 224
WIRE 640 480 400 480
WIRE 880 480 880 272
WIRE 880 480 640 480
WIRE 1104 480 1104 96
WIRE 1104 480 880 480
WIRE 1440 480 1440 336
WIRE 1440 480 1104 480
WIRE 1600 480 1600 144
WIRE 1600 480 1440 480
WIRE 1856 480 1856 240
WIRE 1856 480 1600 480
WIRE 2112 480 2112 272
WIRE 2112 480 1856 480
WIRE 2352 480 2352 96
WIRE 2352 480 2112 480
WIRE 2640 480 2352 480
WIRE 2912 480 2912 112
WIRE 2912 480 2640 480
WIRE 3120 480 3120 -80
WIRE 3120 480 2912 480
WIRE 3328 480 3328 112
WIRE 3328 480 3120 480
WIRE 3488 480 3488 128
WIRE 3488 480 3328 480
WIRE 3648 480 3488 480
WIRE 3920 480 3920 -48
WIRE 3920 480 3648 480
WIRE 2640 496 2640 480
FLAG 2640 496 0
FLAG 2880 -176 Vin
FLAG 944 176 Vcurrent
FLAG 2176 176 Vvoltage
FLAG 1200 64 Vicomparator
FLAG 2448 64 Vvcomparator
SYMBOL ind 240 -160 R0
SYMATTR InstName L1
SYMATTR Value 40mH
SYMBOL res 240 352 R0
SYMATTR InstName R2
SYMATTR Value 0.56493
SYMBOL res 240 -16 R0
SYMATTR InstName R1
SYMATTR Value 17.034
SYMBOL voltage -16 0 R0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 19.79898987 50)
SYMATTR Value2 AC 19.79898987
SYMBOL res 1424 64 R0
SYMATTR InstName R3
SYMATTR Value 820k
SYMBOL res 1424 240 R0
SYMATTR InstName R4
SYMATTR Value 39k
SYMBOL PowerProducts/LT1085-5 3120 -176 R0
SYMATTR InstName Reg1
SYMBOL res 2864 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rin1
SYMATTR Value 33
SYMBOL diode 2688 -160 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap 2896 48 R0
SYMATTR InstName Cin1
SYMATTR Value 470µ
SYMATTR SpiceLine Rser=0.001
SYMBOL cap 3312 48 R0
SYMATTR InstName Cout1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=0.001
SYMBOL Opamps/opamp2 3920 -144 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 3632 -192 R0
SYMATTR InstName R8
SYMATTR Value 39k
SYMBOL res 3632 -48 R0
SYMATTR InstName R9
SYMATTR Value 27k
SYMBOL res 3632 384 R0
SYMATTR InstName R11
SYMATTR Value 39
SYMBOL res 3632 64 R0
SYMATTR InstName R10
SYMATTR Value 1.2k
SYMBOL Opamps/opamp2 624 112 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL res 544 192 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R12
SYMATTR Value 3.9k
SYMBOL res 544 128 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R13
SYMATTR Value 3.9k
SYMBOL res 672 64 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R14
SYMATTR Value 8.2k
SYMBOL res 576 320 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R15
SYMATTR Value 8.2k
SYMBOL res 848 160 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 10k
SYMBOL cap 896 272 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf2
SYMATTR Value 15.91549n
SYMBOL Opamps/opamp2 1824 112 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res 1744 192 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R6
SYMATTR Value 18k
SYMBOL res 1744 128 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R16
SYMATTR Value 56k
SYMBOL res 1872 64 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R17
SYMATTR Value 56k
SYMBOL res 1776 320 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R18
SYMATTR Value 56k
SYMBOL res 2080 160 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf3
SYMATTR Value 10k
SYMBOL cap 2128 272 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf3
SYMATTR Value 15.91549n
SYMBOL res 3472 32 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL Opamps/opamp2 1104 0 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL Opamps/opamp2 2352 0 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U5
SYMATTR Value LM324
TEXT 0 672 Left 2 ;.ac dec 30 1 1Meg
TEXT 0 608 Left 2 !.lib LM324.lib
TEXT -8 544 Left 2 ;Simulation Commands\n- Change these as needed
TEXT 0 640 Left 2 !.tran 0 1 0 0.1m
TEXT 0 704 Left 2 !.ic V(Vin)=8
RECTANGLE Normal -40 528 396 732 2
