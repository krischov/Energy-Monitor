Version 4
SHEET 1 4772 1444
WIRE 4128 -384 2592 -384
WIRE 1104 -304 736 -304
WIRE 1904 -304 1104 -304
WIRE 2304 -304 1904 -304
WIRE 3584 -304 2304 -304
WIRE 3856 -304 3584 -304
WIRE 256 -176 -16 -176
WIRE 1392 -176 256 -176
WIRE 2624 -176 1392 -176
WIRE 2704 -176 2688 -176
WIRE 2816 -176 2784 -176
WIRE 2848 -176 2816 -176
WIRE 2928 -176 2848 -176
WIRE 3264 -176 3184 -176
WIRE 3424 -176 3264 -176
WIRE 3584 -176 3584 -304
WIRE 3584 -176 3424 -176
WIRE 4000 -176 3712 -176
WIRE 256 -144 256 -176
WIRE 3856 -112 3856 -304
WIRE 3712 -96 3712 -176
WIRE 3824 -96 3712 -96
WIRE 4000 -80 4000 -176
WIRE 4000 -80 3888 -80
WIRE 4128 -80 4128 -384
WIRE 4128 -80 4000 -80
WIRE 3584 -64 3584 -96
WIRE 3824 -64 3584 -64
WIRE 3584 -32 3584 -64
WIRE 256 0 256 -64
WIRE -16 16 -16 -176
WIRE 1104 32 1104 -304
WIRE 2304 32 2304 -304
WIRE 1072 48 1056 48
WIRE 2272 48 2256 48
WIRE 2848 48 2848 -176
WIRE 3264 48 3264 -176
WIRE 3424 48 3424 -176
WIRE 1200 64 1136 64
WIRE 2400 64 2336 64
WIRE 576 80 560 80
WIRE 688 80 656 80
WIRE 1072 80 880 80
WIRE 1392 80 1392 -176
WIRE 1728 80 1712 80
WIRE 1840 80 1808 80
WIRE 2272 80 2064 80
WIRE 3584 80 3584 48
WIRE 448 144 400 144
WIRE 560 144 560 80
WIRE 560 144 528 144
WIRE 736 144 736 -304
WIRE 736 144 624 144
WIRE 1600 144 1552 144
WIRE 1712 144 1712 80
WIRE 1712 144 1680 144
WIRE 1904 144 1904 -304
WIRE 1904 144 1776 144
WIRE 560 160 560 144
WIRE 592 160 560 160
WIRE 1712 160 1712 144
WIRE 1744 160 1712 160
WIRE 688 176 688 80
WIRE 688 176 656 176
WIRE 752 176 688 176
WIRE 880 176 880 80
WIRE 880 176 832 176
WIRE 944 176 880 176
WIRE 1840 176 1840 80
WIRE 1840 176 1808 176
WIRE 1936 176 1840 176
WIRE 2064 176 2064 80
WIRE 2064 176 2016 176
WIRE 2128 176 2064 176
WIRE 592 192 560 192
WIRE 1744 192 1712 192
WIRE 256 208 256 80
WIRE 448 208 256 208
WIRE 560 208 560 192
WIRE 560 208 528 208
WIRE 880 208 880 176
WIRE 1392 208 1392 160
WIRE 1600 208 1392 208
WIRE 1712 208 1712 192
WIRE 1712 208 1680 208
WIRE 2064 208 2064 176
WIRE 560 224 560 208
WIRE 624 224 624 208
WIRE 640 224 624 224
WIRE 1712 224 1712 208
WIRE 1776 240 1776 208
WIRE 1808 240 1776 240
WIRE 1392 256 1392 208
WIRE 256 368 256 208
WIRE 560 384 560 304
WIRE 1056 384 1056 48
WIRE 1056 384 560 384
WIRE 1712 384 1712 304
WIRE 1712 384 1056 384
WIRE 2256 384 2256 48
WIRE 2256 384 1712 384
WIRE 2592 384 2592 -384
WIRE 2592 384 2256 384
WIRE 3584 400 3584 160
WIRE -16 480 -16 96
WIRE 256 480 256 448
WIRE 256 480 -16 480
WIRE 400 480 400 144
WIRE 400 480 256 480
WIRE 640 480 640 224
WIRE 640 480 400 480
WIRE 880 480 880 272
WIRE 880 480 640 480
WIRE 1104 480 1104 96
WIRE 1104 480 880 480
WIRE 1392 480 1392 336
WIRE 1392 480 1104 480
WIRE 1552 480 1552 144
WIRE 1552 480 1392 480
WIRE 1808 480 1808 240
WIRE 1808 480 1552 480
WIRE 2064 480 2064 272
WIRE 2064 480 1808 480
WIRE 2304 480 2304 96
WIRE 2304 480 2064 480
WIRE 2576 480 2304 480
WIRE 2848 480 2848 112
WIRE 2848 480 2576 480
WIRE 3056 480 3056 -80
WIRE 3056 480 2848 480
WIRE 3264 480 3264 112
WIRE 3264 480 3056 480
WIRE 3424 480 3424 128
WIRE 3424 480 3264 480
WIRE 3584 480 3424 480
WIRE 3856 480 3856 -48
WIRE 3856 480 3584 480
WIRE 2576 496 2576 480
FLAG 2576 496 0
FLAG 2816 -176 Vin
FLAG 944 176 Vcurrent
FLAG 2128 176 Vvoltage
FLAG 1200 64 Vicomparator
FLAG 2400 64 Vvcomparator
SYMBOL ind 240 -160 R0
SYMATTR InstName L1
SYMATTR Value 40mH
SYMBOL res 240 352 R0
SYMATTR InstName R2
SYMATTR Value 0.56493
SYMBOL res 240 -16 R0
SYMATTR InstName R1
SYMATTR Value 17.034
SYMBOL voltage -16 0 R0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 19.79898987 50)
SYMATTR Value2 AC 19.79898987
SYMBOL res 1376 64 R0
SYMATTR InstName R3
SYMATTR Value 820k
SYMBOL res 1376 240 R0
SYMATTR InstName R4
SYMATTR Value 39k
SYMBOL PowerProducts/LT1085-5 3056 -176 R0
SYMATTR InstName Reg1
SYMBOL res 2800 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rin1
SYMATTR Value 33
SYMBOL diode 2624 -160 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap 2832 48 R0
SYMATTR InstName Cin1
SYMATTR Value 470µ
SYMATTR SpiceLine Rser=0.001
SYMBOL cap 3248 48 R0
SYMATTR InstName Cout1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=0.001
SYMBOL Opamps/opamp2 3856 -144 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 3568 -192 R0
SYMATTR InstName R8
SYMATTR Value 39k
SYMBOL res 3568 -48 R0
SYMATTR InstName R9
SYMATTR Value 27k
SYMBOL res 3568 384 R0
SYMATTR InstName R11
SYMATTR Value 39
SYMBOL res 3568 64 R0
SYMATTR InstName R10
SYMATTR Value 1.2k
SYMBOL Opamps/opamp2 624 112 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL res 544 192 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R12
SYMATTR Value 3.9k
SYMBOL res 544 128 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R13
SYMATTR Value 3.9k
SYMBOL res 672 64 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R14
SYMATTR Value 8.2k
SYMBOL res 576 320 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R15
SYMATTR Value 8.2k
SYMBOL res 848 160 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 10k
SYMBOL cap 896 272 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf2
SYMATTR Value 15.91549n
SYMBOL Opamps/opamp2 1776 112 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res 1696 192 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R6
SYMATTR Value 18k
SYMBOL res 1696 128 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R16
SYMATTR Value 56k
SYMBOL res 1824 64 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R17
SYMATTR Value 56k
SYMBOL res 1728 320 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R18
SYMATTR Value 56k
SYMBOL res 2032 160 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf3
SYMATTR Value 10k
SYMBOL cap 2080 272 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf3
SYMATTR Value 15.91549n
SYMBOL res 3408 32 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL Opamps/opamp2 1104 0 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL Opamps/opamp2 2304 0 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U5
SYMATTR Value LM324
TEXT 0 672 Left 2 ;.ac dec 30 1 1Meg
TEXT 0 608 Left 2 !.lib LM324.lib
TEXT -8 544 Left 2 ;Simulation Commands\n- Change these as needed
TEXT 0 640 Left 2 !.tran 0 1 0 0.1m
TEXT 0 704 Left 2 !.ic V(Vin)=8
RECTANGLE Normal -40 528 396 732 2
