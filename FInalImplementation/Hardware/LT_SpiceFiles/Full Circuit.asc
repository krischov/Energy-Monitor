Version 4
SHEET 1 6628 2468
WIRE 1040 -800 912 -800
WIRE 1312 -800 1040 -800
WIRE 1040 -784 1040 -800
WIRE 1456 -784 1168 -784
WIRE 1312 -720 1312 -800
WIRE 1168 -704 1168 -784
WIRE 1280 -704 1168 -704
WIRE 1456 -688 1456 -784
WIRE 1456 -688 1344 -688
WIRE 1520 -688 1456 -688
WIRE -384 -672 -400 -672
WIRE -272 -672 -304 -672
WIRE -240 -672 -272 -672
WIRE 96 -672 16 -672
WIRE 256 -672 96 -672
WIRE 336 -672 256 -672
WIRE 1040 -672 1040 -704
WIRE 1280 -672 1040 -672
WIRE 1040 -640 1040 -672
WIRE -1568 -608 -1568 -640
WIRE -1072 -544 -1072 -592
WIRE -912 -544 -1072 -544
WIRE -816 -544 -912 -544
WIRE 1040 -528 1040 -560
WIRE -1072 -496 -1072 -544
WIRE -912 -496 -912 -544
WIRE -1568 -464 -1568 -528
WIRE -304 -448 -304 -672
WIRE 96 -448 96 -672
WIRE 256 -448 256 -672
WIRE -912 -400 -912 -432
WIRE 1040 -400 1040 -448
WIRE -1568 -336 -1568 -384
WIRE -1456 -336 -1568 -336
WIRE -1424 -336 -1456 -336
WIRE 1184 -320 1040 -320
WIRE 1312 -320 1312 -656
WIRE 1312 -320 1184 -320
WIRE -1568 -272 -1568 -336
WIRE -1568 -272 -1600 -272
WIRE -1536 -272 -1568 -272
WIRE -304 -272 -304 -384
WIRE -112 -272 -112 -576
WIRE -112 -272 -304 -272
WIRE -16 -272 -112 -272
WIRE 96 -272 96 -384
WIRE 96 -272 -16 -272
WIRE 256 -272 256 -368
WIRE 256 -272 96 -272
WIRE -1456 -240 -1456 -272
WIRE -1568 -192 -1600 -192
WIRE -1536 -192 -1568 -192
WIRE -1568 -160 -1568 -192
WIRE -1456 -128 -1456 -176
WIRE -2288 80 -2304 80
WIRE -2176 80 -2208 80
WIRE -976 128 -992 128
WIRE -2416 144 -2464 144
WIRE -2304 144 -2304 80
WIRE -2304 144 -2336 144
WIRE -2128 144 -2240 144
WIRE -848 144 -912 144
WIRE -2304 160 -2304 144
WIRE -2272 160 -2304 160
WIRE -1632 160 -1648 160
WIRE -1504 160 -1552 160
WIRE -1440 160 -1504 160
WIRE -976 160 -992 160
WIRE -2176 176 -2176 80
WIRE -2176 176 -2208 176
WIRE -2112 176 -2176 176
WIRE -2272 192 -2304 192
WIRE -1504 192 -1504 160
WIRE -2416 208 -2544 208
WIRE -2304 208 -2304 192
WIRE -2304 208 -2336 208
WIRE -2304 224 -2304 208
WIRE -2352 672 -2368 672
WIRE -2240 672 -2272 672
WIRE -1504 704 -1552 704
WIRE -1440 704 -1504 704
WIRE -2368 736 -2368 672
WIRE -2368 736 -2400 736
WIRE -2176 736 -2304 736
WIRE -1504 736 -1504 704
WIRE -2368 752 -2368 736
WIRE -2336 752 -2368 752
WIRE -2240 768 -2240 672
WIRE -2240 768 -2272 768
WIRE -2192 768 -2240 768
WIRE -2336 784 -2368 784
WIRE -2368 800 -2368 784
WIRE -2368 800 -2400 800
WIRE -2368 816 -2368 800
WIRE -960 816 -976 816
WIRE -832 832 -896 832
WIRE -960 848 -976 848
WIRE -2368 928 -2368 896
WIRE 32 1344 -272 1344
WIRE 720 1344 416 1344
WIRE -208 1424 -208 1392
WIRE 480 1424 480 1392
WIRE -272 1440 -272 1344
WIRE -240 1440 -272 1440
WIRE 416 1440 416 1344
WIRE 448 1440 416 1440
WIRE -64 1456 -176 1456
WIRE 32 1456 32 1344
WIRE 32 1456 0 1456
WIRE 80 1456 32 1456
WIRE 192 1456 80 1456
WIRE 624 1456 512 1456
WIRE 720 1456 720 1344
WIRE 720 1456 688 1456
WIRE 768 1456 720 1456
WIRE 880 1456 768 1456
WIRE -240 1472 -288 1472
WIRE 448 1472 400 1472
WIRE 192 1488 192 1456
WIRE 880 1488 880 1456
WIRE 80 1504 80 1456
WIRE 768 1504 768 1456
WIRE -208 1600 -208 1488
WIRE 80 1600 80 1568
WIRE 80 1600 -208 1600
WIRE 192 1600 192 1568
WIRE 192 1600 80 1600
WIRE 480 1600 480 1488
WIRE 768 1600 768 1568
WIRE 768 1600 480 1600
WIRE 880 1600 880 1568
WIRE 880 1600 768 1600
WIRE 80 1632 80 1600
WIRE 768 1632 768 1600
FLAG -272 -672 Vin
FLAG -1440 160 Vis_filtered
FLAG -1440 704 Vvs_filtered
FLAG -848 144 Vicomparator
FLAG -832 832 Vvcomparator
FLAG -288 1472 Vis_filtered
FLAG -208 1392 5_Volt_Line
FLAG 80 1632 0
FLAG 400 1472 Vvs_filtered
FLAG 480 1392 5_Volt_Line
FLAG 768 1632 0
FLAG 336 -672 5_Volt_Line
FLAG -464 -672 Vac
FLAG 1520 -688 2.1_Volt_Line
FLAG 912 -800 5_Volt_Line
FLAG -16 -272 0
FLAG 1184 -320 0
FLAG -928 864 0
FLAG -928 800 5_Volt_Line
FLAG -976 816 2.1_Volt_Line
FLAG -976 848 Vvs_filtered
FLAG -2320 -576 0
FLAG -2320 -656 Vac
FLAG -1568 -640 Vac
FLAG -1568 -160 0
FLAG -1424 -336 Vis
FLAG -2240 208 0
FLAG -944 176 0
FLAG -2464 144 0
FLAG -1456 -128 0
FLAG -1504 256 0
FLAG -2544 208 Vis
FLAG -944 112 5_Volt_Line
FLAG -2128 144 5_Volt_Line
FLAG -2176 736 5_Volt_Line
FLAG -2368 928 2.1_Volt_Line
FLAG -2304 800 0
FLAG -2480 736 0
FLAG -1072 -416 0
FLAG -912 -336 0
FLAG -2304 304 2.1_Volt_Line
FLAG -992 128 2.1_Volt_Line
FLAG -1072 -672 Vac
FLAG -816 -544 Vvs
FLAG -2480 800 Vvs
FLAG -2112 176 Vis_unfiltered
FLAG -1648 160 Vis_unfiltered
FLAG -1504 800 0
FLAG -992 160 Vis_filtered
FLAG -2192 768 Vvs_unfiltered
FLAG -1632 704 Vvs_unfiltered
SYMBOL ind -1584 -624 R0
SYMATTR InstName L1
SYMATTR Value 40mH
SYMBOL res -1584 -480 R0
SYMATTR InstName R1
SYMATTR Value 17.034
SYMBOL voltage -2320 -672 R0
WINDOW 39 0 0 Left 0
SYMATTR InstName Vac
SYMATTR Value SINE(0 17.81909089 50)
SYMATTR Value2 AC 19.79898987
SYMBOL res -1088 -688 R0
SYMATTR InstName R3
SYMATTR Value 82k
SYMBOL res -1088 -512 R0
SYMATTR InstName R4
SYMATTR Value 3.9k
SYMBOL PowerProducts/LT1085-5 -112 -672 R0
SYMATTR InstName Reg1
SYMBOL res -288 -688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rin1
SYMATTR Value 33
SYMBOL diode -464 -656 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL cap -320 -448 R0
SYMATTR InstName Cin1
SYMATTR Value 470µ
SYMATTR SpiceLine Rser=0.001
SYMBOL cap 80 -448 R0
SYMATTR InstName Cout1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=0.001
SYMBOL Opamps/opamp2 1312 -752 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U3
SYMATTR Value LM324
SYMBOL res 1024 -800 R0
SYMATTR InstName R8
SYMATTR Value 39k
SYMBOL res 1024 -656 R0
SYMATTR InstName R9
SYMATTR Value 27k
SYMBOL res 1024 -416 R0
SYMATTR InstName R11
SYMATTR Value 39
SYMBOL res 1024 -544 R0
SYMATTR InstName R10
SYMATTR Value 1.2k
SYMBOL Opamps/opamp2 -2240 112 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U4
SYMATTR Value LM324
SYMBOL res -2320 192 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R12
SYMATTR Value 3.9k
SYMBOL res -2320 128 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R13
SYMATTR Value 3.9k
SYMBOL res -2192 64 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R14
SYMATTR Value 8.2k
SYMBOL res -2288 320 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R15
SYMATTR Value 8.2k
SYMBOL res -1536 144 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf2
SYMATTR Value 4.7k
SYMBOL cap -1488 256 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf2
SYMATTR Value 3.3n
SYMBOL Opamps/opamp2 -2304 704 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U1
SYMATTR Value LM324
SYMBOL res -2384 784 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName R6
SYMATTR Value 18k
SYMBOL res -2384 720 R90
WINDOW 0 -32 53 VBottom 2
WINDOW 3 -32 55 VTop 2
SYMATTR InstName R16
SYMATTR Value 22k
SYMBOL res -2256 656 R90
WINDOW 0 -30 61 VBottom 2
WINDOW 3 -31 62 VTop 2
SYMATTR InstName R17
SYMATTR Value 22k
SYMBOL res -2352 912 R180
WINDOW 0 -62 57 Left 2
WINDOW 3 -44 34 Left 2
SYMATTR InstName R18
SYMATTR Value 22k
SYMBOL res -1536 688 R90
WINDOW 0 62 55 VBottom 2
WINDOW 3 61 57 VTop 2
SYMATTR InstName Rf3
SYMATTR Value 4.7k
SYMBOL cap -1488 800 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf3
SYMATTR Value 3.3n
SYMBOL res 240 -464 R0
SYMATTR InstName R5
SYMATTR Value 100
SYMBOL Opamps/opamp2 -944 80 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL Opamps/opamp2 -928 768 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U5
SYMATTR Value LM324
SYMBOL res -1552 -288 R0
SYMATTR InstName R2
SYMATTR Value 1.2
SYMBOL res -1616 -288 R0
SYMATTR InstName R7
SYMATTR Value 1
SYMBOL Opamps/opamp2 -208 1392 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U6
SYMATTR Value LM324
SYMBOL cap 96 1568 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf1
SYMATTR Value 1000n
SYMBOL res 176 1472 R0
SYMATTR InstName R19
SYMATTR Value 10000k
SYMBOL diode -64 1472 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL Opamps/opamp2 480 1392 R0
WINDOW 0 23 81 Left 2
WINDOW 3 24 105 Left 2
SYMATTR InstName U7
SYMATTR Value LM324
SYMBOL cap 784 1568 R180
WINDOW 0 29 13 Left 2
WINDOW 3 33 -11 Left 2
SYMATTR InstName Cf4
SYMATTR Value 1m
SYMBOL res 864 1472 R0
SYMATTR InstName R20
SYMATTR Value 35k
SYMBOL diode 624 1472 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL zener -928 -400 R0
SYMATTR InstName D4
SYMBOL zener -896 -432 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMBOL zener -1472 -240 R0
SYMATTR InstName D6
SYMBOL zener -1440 -272 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
TEXT -416 2064 Left 2 ;.ac dec 30 1 1Meg
TEXT -416 2000 Left 2 !.lib LM324.lib
TEXT -424 1936 Left 2 ;Simulation Commands\n- Change these as needed
TEXT -416 2032 Left 2 !.tran 0 1 0 0.1m
TEXT -416 2096 Left 2 !.ic V(Vin)=8
TEXT -1136 -728 Left 2 ;Load Voltage Stepdown Divider
TEXT -1064 -704 Left 2 ;G = 45.402*10^-3
TEXT -2504 560 Left 2 ;Load Voltage DC Offset OpAmp
TEXT -2504 1104 Left 2 ;G = 1
TEXT -2504 1136 Left 2 ;DC Offset added : 2.1 Volts
TEXT -2504 1168 Left 2 ;Note: R16 = R17 = R18
TEXT -2480 1192 Left 2 ;= (R6 + Rthevenin) for G = 1.
TEXT -1712 576 Left 2 ;Load Voltage 1st Order Filter Circuit
TEXT -1696 1040 Left 2 ;Cutoff Frequency: 1KHz
TEXT 1056 -872 Left 2 ;OpAmp Voltage Follower DC Offset
TEXT 960 -248 Left 2 ;Voltage divider DC offset created: 2.1 Volts
TEXT 968 -208 Left 2 ;Voltage follower: G = 1
TEXT -2592 -32 Left 2 ;Load Current (represented by Voltage) DC offset opamp
TEXT -2208 -376 Left 2 ;Shunt resistor for voltage divider
TEXT -2248 -352 Left 2 ;Voltage across R2 used to measure current
TEXT -1728 0 Left 2 ;Cutoff Frequency: 1KHz
TEXT -1744 -24 Left 2 ;Load Current 1st Order Filter Circuit
TEXT -2592 -8 Left 2 ;DC offset of 2.1 Added
TEXT -2592 16 Left 2 ;G = 2.1
TEXT -2240 -320 Left 2 ;G = variable depending on R1
TEXT -2888 -568 Left 2 ;Source voltage varies from 12.6 to 15.4 V RMS
TEXT -1792 -728 Left 2 ;RLoad (R1) varies from 17.034 to 94.86 ohms
TEXT -56 1072 Left 2 ;IMPROVED ZERO CROSSING DETECTOR - NEED TO FIND VALUES
TEXT -96 -856 Left 2 ;Linear Regulator
TEXT -1072 592 Left 2 ;Voltage Zero Crossing Detector
LINE Normal -1392 0 -1616 0 1
LINE Normal -1392 432 -1392 0 1
LINE Normal -1616 432 -1392 432 1
LINE Normal -1616 0 -1616 432 1
LINE Normal -2224 -704 -2400 -704 1
LINE Normal -2224 -480 -2224 -704 1
LINE Normal -2400 -480 -2224 -480 1
LINE Normal -2400 -704 -2400 -480 1
RECTANGLE Normal -456 1920 -20 2124 2
RECTANGLE Normal -832 -384 -1104 -688 1
RECTANGLE Normal -2128 1248 -2528 576 1
RECTANGLE Normal -1296 1088 -1712 592 1
RECTANGLE Normal 1008 1824 -464 1104 2
RECTANGLE Normal 512 -176 -544 -832 2
RECTANGLE Normal 1728 -144 752 -832 2
RECTANGLE Normal -640 960 -1184 624 2
RECTANGLE Normal -1440 -368 -1664 -704 1
RECTANGLE Normal -1440 -128 -1664 -304 1
